# dynonet_trajectory_prediction
Scripts to prepare datasets, and train/test a DynoNet network for trajectory predicgtion.

# Steps
* Get original dataset as a CSV file. It should have the following strucure.
    ```csv
    timestamp, tx,ty,tz
    ```
* Run  `python3 resample_data.py` to resample data at equidistant timestamp. Modify the script to read the correct dataset and set the required `dt`. The input dataset are expected to be inside the `original_datasets` directory

* Run `python3 prep_dynonet_dataset.py` to prepare the dataset for dynonet training. This basically creates dataset of trajectories of specified length of the input `window_size_u` and output  `window_size_y` with a predefined frequency `freq`. `freq` is the sampling frequency in `Hz` and has to correspond to the sampling time `dt` defined in `resample_data.py`. The output file is defined by the variable `output_file`.

* Run the `prep_dynonet_dataset.py` script to process the original datasets to one that is suitable for traingin Dynonet network. It can a directory of multiple trajectories and will concatenate them all into one dataset.
    ```bash
    python3 prep_dynonet_dataset.py resampled_100ms_dataset/datasets -o resampled_100ms_dataset -iL 10 -oL 5 -dt 0.1
    ```

* You can use `merge_datasets.py` to merge multiple datasets of different trajectories.

* copy the `*.npz` file generated by `prep_dynonet_dataset.py` to the folder created inside the `examples` folder inside dynonet package.

* Copy the `train.py` and `test.py` to the same folder in step 4

* Modify the `train.py` to read the correct dataset file.

* Modify the `test.py` file to read the correct dataset file